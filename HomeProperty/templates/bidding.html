<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bidding System</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/slick.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/nouislider.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/jquery.fancybox.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/theme-color/default-theme.css') }}"> 

   
    <!-- Google Font -->
    <link href='https://fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <style>
      .property-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        padding: 20px;
      }
      .property-card {
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 8px;
        background: #fff;
        text-align: center;
      }
      .property-card img {
        max-width: 100%;
        border-radius: 8px;
      }
      .property-card h4, .property-card p {
      color: black;
      }
      .bid-button {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        background-color: #4caf50;
        color: white;
        border: none;
        cursor: pointer;
      }
      .bid-button:hover {
        background-color: #45a049;
      }
      .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.4);
      }
      .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 50%;
        border-radius: 8px;
        text-align: center;
      }
      .modal-content label, .modal-content input {
        display: block;
        margin: 10px auto;
      }
      .modal-content input {
        padding: 10px;
        width: 80%;
        text-align: center;
      }
      .modal-content .bid-button {
        margin-top: 15px;
      }
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }
      .close:hover {
        color: black;
      }
    </style>
  </head>
  <header id="aa-header">  
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="aa-header-area">
            <div class="row">
              <div class="col-md-6 col-sm-6 col-xs-6">
                <div class="aa-header-left">
                  <div class="aa-telephone-no">
                    <span class="fa fa-phone"></span>
                    1-900-523-3564
                  </div>
                  <div class="aa-email hidden-xs">
                    <span class="fa fa-envelope-o"></span> info@markups.com
                  </div>
                </div>              
              </div>
              <div class="col-md-6 col-sm-6 col-xs-6">
               <div class="aa-header-right">
                  {% if 'username' in session %}
                    <!-- Show logout button when user is logged in -->
                    <a href="{{ url_for('auth.logout') }}" class="aa-logout">Logout</a>
                  {% else %}
                    <!-- Show login and register when user is NOT logged in -->
                    <a href="{{ url_for('auth.create_account') }}" class="aa-register">Register</a>
                    <a href="{{ url_for('auth.login') }}" class="aa-login">Login</a>
                  {% endif %}
                </div> 
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <section id="aa-menu-area">
    <nav class="navbar navbar-default main-navbar" role="navigation">  
      <div class="container">
        <div class="navbar-header">
          <!-- FOR MOBILE VIEW COLLAPSED BUTTON -->
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          
          <!-- LOGO -->                                               
          <!-- Text based logo -->
          <a class="navbar-brand aa-logo" href="/"> Home <span>Property</span></a>
          <!-- Image based logo -->
          <a class="navbar-brand aa-logo-img" href="/"><img src="{{ url_for('static', filename='img/logo.png') }}" alt="logo"></a> 
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul id="top-menu" class="nav navbar-nav navbar-right aa-main-nav">
              <li><a href="/">HOME</a></li>
              
              <!--
              <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="/agent_dashboard">PROPERTIES <span class="caret"></span></a>
                  <ul class="dropdown-menu" role="menu">
                      <li><a href="/agent_dashboard">PROPERTIES</a></li>
                      <li><a href="/seller_dashboard">PROPERTIES DETAIL</a></li>                                            
                  </ul>
              </li>
          -->
  
              {% if 'username' in session %}
                  {% if session['user_type'] == 'seller' %}
                      <!-- Seller-specific menu -->
                      <li><a href="/list-property">List Property</a></li>
                      <li><a href="/view_your_property">Your Property</a></li>
                  
                  {% elif session['user_type'] == 'agent' %}
                      <!-- Agent-specific menu -->
                      <li class="active"><a href="/view_listed_property">View Listed Property</a></li>
                      <li><a href="/view_bidded_property">View Bidded Property</a></li>
                  {% endif %}
                  
                  <li><a href="/logout" class="aa-logout">Logout</a></li>
              {% else %}
                  <li><a href="/gallery">GALLERY</a></li>                                         
                  <li class="dropdown">
                      <a class="dropdown-toggle" data-toggle="dropdown" href="{{ url_for('blog_archive') }}">BLOG <span class="caret"></span></a>
                      <ul class="dropdown-menu" role="menu">                
                          <li><a href="/blog-archive">BLOG</a></li>
                          <li><a href="/blog-single">BLOG DETAILS</a></li>                                            
                      </ul>
                  </li>
                  <li><a href="/contact">CONTACT</a></li>
                  <li><a href="/create_account" class="aa-register">Register</a></li>
                  <li><a href="/login" class="aa-login">Login</a></li>
              {% endif %}
          </ul>
        </div>
    </nav> 
  </section>

  <body>
    <div class="top-nav">
      <a href="/logout" class="logout-btn">Logout</a>
    </div>

    <div class="container" >
      <header>
        <h1 class="text-center" style="text-align: center";>Property Bidding System</h1>
      </header>

      <!-- <section class="container mt-4">
        <div class="property-grid">
          <div class="property-card" >
            <img src="img/item1.jpg" alt="Property 1">
            <h4 >Modern Apartment</h4>
            <p>2 Beds | 2 Baths | 1200 SQ FT | $35000</p>
            <p>Max Commission: 15%</p>
            <button class="bid-button" onclick="openBidModal('Modern Apartment', 15)"><strong>Bid</strong></button>
          </div>
  
          <div class="property-card">
            <img src="img/item2.jpg" alt="Property 2">
            <h4>Luxury Condo</h4>
            <p>3 Beds | 3 Baths | 1500 SQ FT | $50000</p>
            <p>Max Commission: 20%</p>
            <button class="bid-button" onclick="openBidModal('Luxury Condo', 20)"><strong>Bid</strong></button>
          </div>
  
          <div class="property-card">
            <img src="img/item3.jpg" alt="Property 3">
            <h4>Beachside Villa</h4>
            <p>4 Beds | 4 Baths | 2000 SQ FT | $75000</p>
            <p>Max Commission: 25%</p>
            <button class="bid-button" onclick="openBidModal('Beachside Villa', 25)"><strong>Bid</strong></button>
          </div>
        </div>
      </section> -->

      <section class="container mt-4">
        <div class="property-grid">
          {% for property in listings if property['status'] == 'A' %}

            <div class="property-card">
              <img src="{{ url_for('static', filename='img/item1.jpg') }}" alt="Property Image">
              <h4>{{ property['flat_type'] }} in {{ property['town'] }}</h4>
              <p>{{ property['floor_area'] }} SQ FT | ${{ property['listing_price'] }}</p>
              <p>Max Commission: {{ property['max_com_bid'] }}%</p>
              <strong style="color: black";>Status:</strong>
            {% if property['status'] == 'A' %}
                <span class="badge bg-success">Active</span>
            {% elif property['status'] == 'C' %}
                <span class="badge bg-danger">Sold</span>
            {% else %}
                <span class="badge bg-secondary">Closed</span>
            {% endif %}
            <br>
             
              {% if property['lowest_bid'] is not none %}
              <p style="color: #555;"><strong>Lowest Bid:</strong> {{ property['lowest_bid'] }}%</p>
            {% else %}
              <p style="color: #999;"><em>No bids yet.</em></p>
            {% endif %}
              <button class="bid-button"
              data-title="{{ property['flat_type'] }} in {{ property['town'] }}"
              data-max="{{ property['max_com_bid'] }}"
              data-property-id="{{ property['id'] }}"
              data-status="{{ property['status'] }}"
              onclick="handleBidClick(this)">
              <strong>Bid</strong>
              </button>
            </div>
          {% endfor %}
        </div>
      </section>
      
  
      <!-- Modal for Bidding -->
      <div id="bidModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeBidModal()">&times;</span>
          <h2 id="property-name"></h2>
          <label for="final-commission">Enter Commission (%)</label>
          <input type="number" id="final-commission" class="form-control" placeholder="Enter commission percentage" step="0.1" min="0" oninput="validateDecimal(this)">
          <button class="bid-button" onclick="placeBid()">Submit Bid</button>
        </div>
      </div>
    </div>

    <footer id="aa-footer">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
          <div class="aa-footer-area">
            <div class="row">
              <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="aa-footer-left">
                 <p>Designed by <a rel="nofollow" href="http://www.markups.io/">MarkUps.io</a></p>
                </div>
              </div>
             
              
              </div>            
            </div>
          </div>
        </div>
        </div>
      </div>
    </footer>
    <!-- / Footer -->
   
    
    
    <!-- jQuery library -->
    <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.js') }}"></script>
    <script src="{{ url_for('static', filename='js/slick.js') }}"></script>
    <script src="{{ url_for('static', filename='js/nouislider.js') }}"></script>
    <script src="{{ url_for('static', filename='js/jquery.mixitup.js') }}"></script>
    <script src="{{ url_for('static', filename='js/jquery.fancybox.pack.js') }}"></script>
    <script src="{{ url_for('static', filename='js/custom.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bidding.js') }}"></script>
    <script src="{{ url_for('static', filename='js/login.js') }}"></script>
    <script src="{{ url_for('static', filename='js/logout.js') }}"></script>
    <script>
      function validateDecimal(input) {
        const value = input.value;
        if (!/^\d*(\.\d?)?$/.test(value)) {
          input.value = value.slice(0, -1); // remove last character if it's invalid
        }
      }
    </script>      
  </body>



</html>
  